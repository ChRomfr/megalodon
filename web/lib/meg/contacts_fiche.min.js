function deleteContact(e){if(confirm("Etes vous sur de voiloir supprimer ?")){window.location.href=base_url+"contacts/delete/"+e}}function get_form_add_file(e){$.get(base_url+"contacts/ajax_form_add_file/"+e,{nohtml:"nohtml"},function(e){$("#modal-global-body").html('<div class="well">'+e+"</div>")});$("#modal-global-label").html('<i class="fa fa-cloud-upload"></i>&nbsp;Ajouter un fichier');$("#modal-global").modal("show")}function get_form_add_agence(e,t){$.get(base_url+"contacts/ajax_form_add_agence/"+e,{nohtml:"nohtml",contact:t},function(e){$("#modal-global-body").html('<div class="well">'+e+"</div>")});$("#modal-global-label").html("Nouvelle agence");$("#modal-global").modal("show")}function get_form_suivi(e){$.get(base_url+"contacts/ajax_form_suivi/"+e,{nohtml:"nohtml"},function(e){$("#modal-fiche-contacts-body").html(e)});$("#modal-fiche-contact-label").html("Nouveau suivi");$("#modal-fiche-contacts").modal("show")}function get_form_send_email(e){$.get(base_url+"contacts/ajax_form_sendemail/"+e,{nohtml:"nohtml"},function(e){$("#modal-fiche-contacts-body").html(e)});$("#modal-fiche-contact-label").html("Envoie email");$("#modal-fiche-contacts").modal("show")}function get_form_send_email(e){$.get(base_url+"contacts/ajax_get_email_detail/"+e,{nohtml:"nohtml"},function(e){$("#modal-fiche-contacts-body").html('<div class="well">'+e+"</div>")});$("#modal-fiche-contact-label").html("Envoie email");$("#modal-fiche-contacts").modal("show")}function sendUpload(){$("#uploadStatus").html('<div class="alert alert-info"><i class="fa fa-spinner fa-spin fa-lg"></i><br/>Enregistrement en cour ...</div></div>');return true}function endUpload(e){if(e=="echec"){$("#uploadStatus").html('<div class="alert alert-error">Une erreur est survenu pendant le traitement</div>');$("#FormBienEdit").css("display","block")}else{$(function(){$.pnotify({title:"Fichier",text:"Fichier ajouté au contact",type:"success",opacity:.8})});ReloadFiles(contact.contact_id);$("#uploadStatus").html("")}}function GetFormAddPhone(e){$.get(base_url+"index.php/contacts/AjaxAddPhone/"+e,{nohtml:"nohtml"},function(e){$("#modal-fiche-contacts-body").html(e)});$("#modal-fiche-contact-label").html("Nouveau telephone");$("#modal-fiche-contacts").modal("show")}function ReloadFiles(e){$("#table-contacts-files").find("tr:gt(0)").remove();$.get(base_url+"index.php/contacts/get_files/"+e,{nohtml:"nohtml",json:"json"},function(e){var t='<tr><td><a href="{{url_download}}" title="" target="_blank">{{name}}</td><td>{{identifiant}}</td><td>{{date_add}}</td></tr>';for(var n in e){$("#table-contacts-files").append(Mustache.render(t,e[n]))}},"json")}function deleteSuivi(e){if(confirm("Etes vous sur de vouloir supprimer ce suivi ?")){window.location.href=base_url+"contacts/suividelete/"+e}}function deleteFile(e){if(confirm("Etes vous sur de vouloir supprimer ce fichier ?")){window.location.href=base_url+"contacts/file_delete/"+e}}function DeletePhone(e){if(confirm("Etes vous sur de vouloir supprimer ce téléphone ?")){window.location.href=base_url+"contacts/phone_delete/"+e}}function agenceRemove(e,t){if(confirm("Etes vous sur de vouloir retirer cette agence ?")){window.location.href=base_url+"contacts/agence_remove?agence_id="+e+"&mother="+t}}function gotofiche(e){window.location.href=base_url+"index.php/contacts/detail/"+e}jQuery(document).ready(function(){$("#map-contacts").gmap3({marker:{latLng:[contact.lat,contact.lng]},map:{options:{zoom:14}}});if(contact.lat==""||contact.lng==""||contact.lat==null){$.get(base_url+"index.php/contacts/ajax_geoloc_contact/"+contact.contact_id,{nohtml:"nohtml"},function(e){})}});$(document).ready(function(){$("a").tooltip()});(function(e){e.get(base_url+"index.php/contacts/get_mailings_of_contact/"+contact.contact_id,{nohtml:"nohtml"},function(t){var n="<tr><td>{{id}}</td><td>{{libelle}}</td><td>{{email}}</td><td>{{& open}}</tr>";for(var r in t){e("#table-contacts-mailings").append(Mustache.render(n,t[r]))}},"json")})(jQuery);if(suser.historique_contact==1){(function(e){e.get(base_url+"index.php/contacts/get_logs_of_contact/"+contact.contact_id,{nohtml:"nohtml"},function(t){var n="<tr><td>{{date_log}}</td><td>{{log_user}}</td><td>{{& log}}</td></tr>";for(var r in t){e("#table-contacts-logs").append(Mustache.render(n,t[r]))}},"json")})(jQuery)}if(contact.raison_social!=""){(function(e){e.get(base_url+"index.php/contacts/get_contacts_societe/"+contact.contact_id,{nohtml:"nohtml"},function(t){var n='<tr><td><a href="javascript:gotofiche({{contact_id}})" title="">{{prenom}} {{nom}}</a></td><td>{{email}}</td><td>{{service}}</td><td>{{poste}}</td></tr>';for(var r in t){e("#table-contacts-societe").append(Mustache.render(n,t[r]))}},"json")})(jQuery)}